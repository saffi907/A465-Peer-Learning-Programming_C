{% extends "base.html" %}
{% block title %}Admin Panel{% endblock %}
{% block step1_class %}done{% endblock %}
{% block step2_class %}done{% endblock %}
{% block step3_class %}active{% endblock %}

{% block content %}
<section class="stage-section">
    <div class="dashboard-card">
        <div class="card-header">
            <div class="card-icon">
                <i class="ph ph-shield-check"></i>
            </div>
            <h1>Admin Panel</h1>
            <p class="card-subtitle">Welcome, {{ username }}</p>
        </div>

        <!-- Announcement Feature -->
        <div class="terminal-window">
            <div class="terminal-header">
                <span class="terminal-dot red"></span>
                <span class="terminal-dot yellow"></span>
                <span class="terminal-dot green"></span>
                <span class="terminal-title">System Announcements</span>
            </div>
            <div class="terminal-body">
                <form method="POST" action="{{ url_for('announce') }}">
                    <div class="input-group">
                        <label for="content">
                            <i class="ph ph-megaphone"></i>
                            Post Announcement
                        </label>
                        <textarea id="content" name="content" rows="3" placeholder="Type your announcement here..."
                            class="announcement-input">{{ raw_input if raw_input else '' }}</textarea>
                    </div>
                    <button type="submit" class="btn-primary">
                        <i class="ph ph-paper-plane-tilt"></i>
                        <span>Publish</span>
                    </button>
                </form>

                {% if announcement %}
                <div class="announcement-output">
                    <div class="output-label">
                        <i class="ph ph-terminal"></i> Rendered Output:
                    </div>
                    <div class="output-content">{{ announcement | safe }}</div>
                </div>
                {% endif %}
            </div>
        </div>

        <div class="action-panel">
            <a href="{{ url_for('dashboard') }}" class="btn-secondary">
                <i class="ph ph-arrow-left"></i>
                <span>Back to Dashboard</span>
            </a>
            <a href="{{ url_for('files') }}" class="btn-secondary">
                <i class="ph ph-folder-open"></i>
                <span>File Browser</span>
            </a>
        </div>
    </div>

    <!-- Hint Banner -->
    <div class="hint-banner">
        <i class="ph ph-lightbulb"></i>
        <span>Stage 3: This announcement feature renders your input on the
            <em>server</em>. This app uses <strong>Jinja2</strong> templates.
            What happens if you type template syntax like
            <code>{{ "{{ 7*7 }}" }}</code>? If that works, try
            <code>{{ "{{ config.items() }}" }}</code> to see what secrets the
            server is hiding.</span>
    </div>
</section>
{% endblock %}